\documentclass{article}
% \begin{}

% LaTeX Packages %
%%%%%%%%%%%%%%%%%%
\usepackage{etoolbox}

% Text Packages %
%%%%%%%%%%%%%%%%%
\usepackage[spanish]{babel}
\usepackage[inline]{enumitem}

% Math Packages %
%%%%%%%%%%%%%%%%%
\usepackage{mathtools}
\usepackage{amssymb, amsthm}
\usepackage{physics}
\usepackage{bbm}

% Math symbols %
%%%%%%%%%%%%%%%%
\newcommand{\placeholderParameter}{-}
\newcommand{\characteristic}{\mathbbm{1}}
\newcommand{\naturalNumbers}{\mathbb{N}}
\newcommand{\realNumbers}{\mathbb{R}}
\newcommand{\integrableFunctions}{L^1(\realNumbers^n)}
\newcommand{\locallyIntegrableFunctions}{L^1_{\textnormal{loc}}(\realNumbers^n)}
\newcommand{\local}{\textnormal{loc}}
\newcommand{\closure}[1]{\bar{1}}

\newtheorem{theorem}{Teorema}
\newtheorem{definition}{Definición}
\newtheorem{myDefinition}{Definición propia}
\newtheorem{exercise}{Ejercicio}
\newtheorem{lemma}{Lema}
\newtheorem{myLemma}{Lema propio}

\DeclareMathOperator{\lebesgueMeasure}{\lambda}
\DeclareMathOperator{\support}{\textnormal{sop}}

% Math intervals %
%%%%%%%%%%%%%%%%%%
\newcommand{\leftOpenInterval}{\left]}
\newcommand{\rightOpenInterval}{\right[}
\newcommand{\leftClosedInterval}{\left[}
\newcommand{\rightClosedInterval}{\right]}
\newcommand{\interval}[3]{%
  \ifstrequal{#1}{oo}{%
    \leftOpenInterval #2, #3 \rightOpenInterval%
  }{%
    \ifstrequal{#1}{co}{%
      \leftClosedInterval #2, #3 \rightOpenInterval%
    }{%
      \ifstrequal{#1}{oc}{
        \leftOpenInterval #2, #3 \rightClosedInterval%
      }{%
        \ifstrequal{#1}{cc}{
          \leftClosedInterval #2, #3 \rightClosedInterval
        }{%
        }%
      }%
    }%
  }%
}
% End math intervals %
%%%%%%%%%%%%%%%%%%%%%%

\theoremstyle{remark}
\newtheorem{remark}{Observación}

\title{Soluciones positivas a la ecuación del calor}
\author{Pablo Brianese}
% \end{}
\begin{document}
  \maketitle

  % Libro: Primer curso de ecuaciones en derivadas parciales
  % Página: 310

  Esta sección está dedicada a un resultado muy interesante por razones matemáticas y por su significado físico.

  Una de las consecuencias de \emph{Segundo Principio de la Termidinámica} es que la \emph{temperatura absoluta} es siempre positiva.
  Este hecho sugiere que la condición natural a verificar por las soluciones de la ecuación del calor es la condición \emph{unilateral}, \(u \geq 0\).
  Evidentemente es lo mismo suponer \(u \geq H\), pues el cambio en la escala de temperaturas \(v = u - H\), conduce al caso \(v \geq 0\).

  Sugerimos al lector recordar las leyes de la termodinámica, para lo cual una hermosa referencia puede ser el celebérrimo curso de R.P. Feynman.

  Presentaremos un resultado obtenido en 1944 por D. Widder, profesor de Harvard.
  Widder prueba que con la condición físicamente natural de que la temperatura sea positiva, el problema de Cauchy para la ecuación del calor tiene una única solución.
  Desde el punto de vista matemático este resultado es muy interesante, dado que se establece la unicidad con una condición unilateral solamente, es decir, \(u(x, t) \geq 0\).

  En realidad, D. Widder probó más cosas, por ejemplo, que una solución de la ecuación sea positiva y continua, se puede expresar en tiempo \(t\) por la integral de la solución fundamental por el valor de dicha solución en un tiempo anterior.
  Es decir, la fórmula
  \begin{align}
    \label{equation:heatEquationRepresentationFormula}
    u(x, t)
    =
    \frac{1}{\sqrt{4 \pi t}^N} \int_{\realNumbers^N} \exp\!\left(- \frac{\abs{x - y}^2}{4 t}\right) u(y, 0) \dd y
  \end{align}
  caracteriza las soluciones positivas.

  Precisaremos estos enunciados en su momento.
  Antes de nada diremos que la referencia que seguiremos es el trabajo del propio Widder, que se recoge en el libro: \textit{D. Widder, ” The heat equation”, Academic Press, 1975.}.

  Empezaremos estableciendo otro resultado de unicidad, que tiene interés por sí mismo al recoger una hipótesis natural de crecimiento del dato y la solución, y que se usará a continuación.
  Dicho resultado está en el espíritu del teorema
  \ref{} % 6.2.3
  cambiando la acotación por la ley de crecimiento \(\abs{u(x, t)} \leq A e^{a \abs{x}^2}\).
  Este crecimiento es el natural, teniendo en cuenta el decaimiento en el infinito de la solución fundamental.

  Más precisamente se tiene el siguiente enunciado.

  \begin{theorem}
    Sea \(u \in C(\realNumbers^N \times \interval{oo}{0}{T})\), verificando el problema
    \begin{align}
      \left(
        \begin{aligned}        
          &u_t - \laplacian u = 0
            && (x, t) \in \realNumbers^n \times \interval{oo}{0}{T}
          \\
          & \abs{u(x, t)} < M e^{a \abs{x}^2}
            && (x, t) \in \realNumbers^n \times \interval{oo}{0}{T}
          \\
          &u(x, 0) = 0
            && x \in \realNumbers^N
        \end{aligned}
      \right.
    \end{align}
    para ciertas constantes positivas \(M, a\).
    Entonces \(u(x, t) = 0\) para todo \((x, t) \in \realNumbers^N \times \interval{oo}{0}{T}\).
  \end{theorem}
  \begin{proof}
    La demostración se hace iterando el resultado sobre intervalos del tiempo de longitud convenientemente pequeña.
    Para empezar elegimos \(A\) tal que \(A > a\) y \(A > 1 / (4 T)\).
    Consideramos la función
    \begin{align}
      v(x, t) = \frac{1}{\sqrt{1 - 4 A t}^N} \exp\!\left(\frac{A \abs{x}^2}{1 - 4 A t}\right)
    \end{align}
    que como se observa es precisamente
    \begin{align}
      \label{equation:shortTimeHeatEquationSolution}
      &v(x, t)
      =
      \sqrt{4 \pi}^N K_{1 + \lambda^2 t} (\lambda x)
      && \text{donde } \lambda = i \sqrt{4A}
    \end{align}
    y \(K_t(x)\) es la solución fundamental de la ecuación del calor como se obtuvo en la sección 
    \ref{}  % 6.1
    .
    Simplemente la regla de la cadena y la expresión
    \ref{equation:shortTimeHeatEquationSolution}
    demuestran que \(v(x, t)\) es solución de la ecuación del calor en \(\realNumbers^N \times \interval{oo}{0}{1 / (4 A)}\).
    Además, como para cada \(x \in \realNumbers^N\), \(v(x, t)\) es una función creciente en \(t\), se concluye que
    \begin{align}
      &v(x, t)
      \geq
      v(x, 0)
      =
      e^{A \abs{x}^2}
      && (x, t) \in \realNumbers^N \times \interval{oo}{0}{1 / (4 A)}
    \end{align}
    Fijando un punto \((x_0, t_0)\) en la banda \(\realNumbers^N \times \interval{oo}{0}{1 / (4 A)}\), elegimos \(R > \abs{x_0}\) y tomamos un múltiplo de la función \(v\).
    Exactamente tomamos
    \begin{align}
      w(x, t)
      =
      M e^{(a - A) R^2} v(x, t)
    \end{align}
    Sea ahora el cilindro \(D = \{(x, t) | \abs{x} < R, 0 < t < 1 / (4 A)\}\) y comparemos las funciones \(\abs{u(x, t)}\) y \(w(x, t)\) sobre la frontera parabólica de \(D\), es decir, sobre los puntos \((x, 0)\), con \(\abs{x} < R\) y los puntos \((x, t)\), con \(\abs{x} = R\) y \(0 \leq t \leq 1 / (4 A)\).
    Sobre los primeros, es decir, la base, se tiene 
    \begin{align}
      \abs{u(x, 0)}
      =
      0
      <
      w(x, 0)
      =
      M e^{(a - A) R^2} e^{A \abs{x}^2}
    \end{align}
    y sobre la superficie lateral, es decir si \(\abs{x} = R\)
    \begin{align}
      \abs{u(x, t)}
      <
      M e^{a R^2}
      \leq
      M e^{(a - A) R^2 v(x, 0)}
      \leq
      M e {(a - A) R^2} v(x, t)
      =
      w(x, t)
    \end{align}
    Por tanto, aplicando el principio del máximo, teorema 
    \ref{}  % 6.2.1
    , se concluye que
    \begin{align}
      &- w(x, t) \leq u(x, t) \leq w(x, t)
      && \text{para } (x, t) \in D
    \end{align}
    En particular,
    \begin{align}
      \label{inequality:fundamentalSolutionBound}
      \abs{u(x_0, t_0)}
      <
      M e^{(a - A) R^2} v(x_0, t_0)
    \end{align}
    que se verifica para todo \(R > \abs{x}\).
    Tomando límites en \ref{inequality:fundamentalSolutionBound} cuando \(R \rightarrow \infty\), obtenemos
    \begin{align}
      &u(x_0, t_0) = 0
      && (x_0, t_0) \in \realNumbers^N \times \interval{oo}{0}{1 / (4 A)}
    \end{align}
    ya que hemos elegido \(A > a\).
    Para acabar, repetimos el argumento anterior a la función \(u(x, t + \tau)\), con \(0 < \tau < 1 / (4 A)\);
    de esta forma concluimos que \(u(x, y) \equiv 0\) en \(\realNumbers^N \times \interval{oo}{0}{ 2 / (4 A)}\).
    Repitiendo el argumento una cantidad finita de veces, concluímos la prueba.
  \end{proof}

  %Lema 6.4.2 al Teorema 6.4.6
  \begin{lemma} % 6.4.2
    Sea \(u(x, t)\) solución de la ecuación del calor tal que \(u(x,0) = 0\), entonces \(v(x, t) = \int_0^t u(x, s) \dd s\) es solución de la ecuación del calor.
    Además si \(u\) es positiva, \(v\) es creciente en \(t\) para \(x\) fijo y es subharmónica como función de \(x\) para \(t\) fijo.
  \end{lemma}
  \begin{proof}
    En efecto, en primer lugar, \(v_t = u\) en virtud del teorema fundamental del cálculo.
    En segundo lugar
    \begin{align}
      \laplacian v (x , t)
      =
      \int_0^t \laplacian u (x, s) \dd s
      =
      \int_0^t u_s(x, s) \dd s
      =
      u(x, t)
    \end{align}
    por tanto, \(v_t = \laplacian v\), es decir, \(v\) satisface la ecuación del calor.

    Si \(u \geq 0\) se tiene \(v_t = u = \laplacian v \geq 0\), por tanto tenemos las propiedades anunciadas para \(v\).
  \end{proof}

  Necesitaremos el siguiente lema, que viene a establecer que entre todas las posibles soluciones positivas de la ecuación del calor, la más pequeña es la que da la fórmula integral
  \ref{equation:heatEquationRepresentationFormula}  % 6.1.3
  .
  Este resultado será crucial para probar el resultado de unicidad, y como consecuencia, el teorema de representación de soluciones positivas de Widder.

  \begin{lemma} %6.4.3
    Sea \(u \in C(\realNumbers^n \times \interval{co}{0}{T})\) tal que \(u_t, u_{x_i x_j} \in C(\realNumbers^n \times \interval{oo}{0}{T})\).
    Supongamos que
    \begin{enumerate}
      \item \(u_t - \laplacian u = 0\) en \(\realNumbers^n \times \interval{co}{0}{T}\);
      \item \(u(x, t) \geq 0\) en \(\realNumbers^n \times \interval{co}{0}{T}\). 
    \end{enumerate}
    Entonces se verifica
    \begin{align}
      \label{inequality:Kt-u-convolutionInequality}
      \int_{\realNumbers^n} K_t(x - y) u(y, 0) \dd y
      \leq
      u(x, t)
    \end{align}
  \end{lemma}
  \begin{proof}
    Con las hipótesis que tenemos, lo primero que no está claro es que la integral en \ref{inequality:Kt-u-convolutionInequality} sea finita.
    Por simplicidad llamaremos \(f(x) = u(x, 0)\) y consideramos una función de corte regular, precisamente, \(\phi \in C^{\infty}_0(\realNumbers^n)\) verificando
    \begin{align}
      \phi_R(x)
      =
      \left\{
        \begin{aligned}
          & 1
            && \text{si } \abs{x} \leq R - 1
          \\
          & R - \abs{x}
            && \text{si } R - 1 \leq \abs{x} \leq R
          \\
          & 0
            && \text{si } R \leq \abs{x}
        \end{aligned}
      \right.
    \end{align}
    Si se define ahora
    \begin{align}
      v_R(x, t)
      =
      \int_{\realNumbers^n} K_t(x - y) f(y) \phi_R(y) \dd y
    \end{align}
    es finita pues \(f \phi\) es continua y con soporte en una bola.
    El teorema \ref{}  % 6.1.1
    establece que la función \(v_R\) definida por \ref{}  % 6.4.9
    verifica el problema
    \begin{align}
      \left\{
        \begin{aligned}
          & \frac{\partial v_R}{\partial t} - \laplacian v_R = 0
            && (x, t) \in \realNumbers^n \times \interval{oo}{0}{T}
          \\
          & v_R(x, t) \geq 0
            && (x, t) \in \realNumbers^n \times \interval{oo}{0}{T}
          \\
          & v_R(x, 0) = f(x)\phi_R(x)
            && x \in \realNumbers^n
        \end{aligned}
      \right.
    \end{align}
    Sea \(M_R = \max_{\abs{y} < R} f(y)\) y sea \(\abs{x} > R\), entonces
    \begin{align}
      0
      &\leq
      v_R(x, t)
      \\
      &\leq
      M \int_{\abs{y} < R} K(x - y, t) \dd y
      \\
      &\leq
      \frac{M}{\sqrt{\pi}^n} \int_{\abs{y} < R} \frac{1}{\abs{x - y}^n} \dd y
      \\
      &\leq
      \frac{M}{\sqrt{\pi}^n} \int_{\abs{y} < R} \frac{1}{\abs{\abs{x} - R}^n} \dd y
      \\
      &\leq
      \frac{M R^n c_n}{\abs{\abs{x} - R}^n}
    \end{align}
    pues se tiene que \(\abs{s}^n e^{- \abs{s}^2} < 1\) y \(\abs{x - y} \geq \abs{\abs{x} - R}\) cuando \(x\) está en el exterior de la bola de radio \(R\).
    Por consiguiente, dado \(\varepsilon > 0\)
    \begin{align}
      & 0 \leq v_R(x, t) \leq \varepsilon
      && \text{si } \abs{x} \geq \rho(M, R, n)
    \end{align}
    En particular, tenemos
    \begin{enumerate}
      \item \(0 \leq v_R(x, t) \leq \varepsilon + u(x, t)\) si \(\abs{x} = \rho\), \(0 < t < T\), ya que por hipótesis \(u\) es positiva en toda la banda.
      \item \(v_R(x, 0) \leq f(x) = u(x, 0) \leq u(x, 0) + \varepsilon\) si \(\abs{x} \leq \rho\).
    \end{enumerate}
    Entonces, \ref{} % i
    y \ref{} % ii
    junto con el principio del máximo, implican que
    \begin{align}
      & v_R(x, t) \leq u(x, t) + \varepsilon
      && \text{si } \abs{x} < \rho, 0 \leq t < T
    \end{align}
    Además de \ref{}  % 6.4.12
    y ser \(u \geq 0\) se concluye que para todo \(\varepsilon > 0\)
    \begin{align}
      &v_R(x, t) \leq u(x, t) + \varepsilon
      && \text{para todo } (x, t) \in \realNumbers^n \times \interval{oo}{0}{T}
    \end{align}
    
    Si observamos que \(v_R(x, t) \leq v_{R'}(x, t)\) y \(\phi_R(x) \leq \phi_{R'}(x)\) si \(R < R'\) en todo punto y para \(0 \leq t < T\), podemos pasar al límite aplicando el teorema de convergencia monótona, es decir, se tiene
    \begin{align}
      0
      \leq
      v(x, t)
      =
      \lim_{R \rightarrow \infty} v_R(x, t)
      =
      \int_{\realNumbers^n} K_t(x - y) f(y) \dd y
      \leq
      u(x, t)
    \end{align}
    que prueba que la integral es finita y, de paso, el lema.
  \end{proof}
\end{document}