\documentclass{article}
% \begin{}
% Text Packages
\usepackage[spanish]{babel}
\usepackage[inline]{enumitem}

% Math Packages
\usepackage{mathtools}
\usepackage{amssymb, amsthm}
\usepackage{physics}
\usepackage{bbm}

\newcommand{\placeholderParameter}{-}
\newcommand{\characteristic}{\mathbbm{1}}
\newcommand{\naturalNumbers}{\mathbb{N}}
\newcommand{\realNumbers}{\mathbb{R}}
\newcommand{\integrableFunctions}{L^1(\realNumbers^n)}
\newcommand{\locallyIntegrableFunctions}{L^1_{\textnormal{loc}}(\realNumbers^n)}
\newcommand{\local}{\textnormal{loc}}
\newcommand{\closure}[1]{\bar{1}}
\newtheorem{definition}{Definición}
\newtheorem{exercise}{Ejercicio}
\newtheorem{myLemma}{Lema propio}

\DeclareMathOperator{\lebesgueMeasure}{\lambda}
\DeclareMathOperator{\support}{\textnormal{sop}}

\theoremstyle{remark}
\newtheorem{remark}{Observación}

\title{Práctica 0 \\ Preliminares de Análisis}
\author{Pablo Brianese}
% \end{}
\begin{document}
\maketitle
% \begin{}
  \begin{definition}
    Dadas \(f, g : \realNumbers^n \rightarrow \realNumbers\) ambas en \(L(\realNumbers^n)\), definimos la convolución de la siguiente manera
    \begin{align}
      (f * g) (x)
      =
      \int_{\realNumbers^n} f(y) g(x - y) \dd y
    \end{align}
  \end{definition}

  \begin{exercise}
    Probar que si \(f, g, h \in L^1(\realNumbers^n)\) y \(\lambda \in \realNumbers\), entonces valen:
    \begin{enumerate}
      \item 
        \label{exercise:convolutionConmutativity}
        \(f * g = g * f\)
      \item
        \label{exercise:convolutionDistributiveLaw}
        \(f * (g + h) = f * g + f * h\)
        a la vez que
        \((g + h) * f = g * f + h * f\)
      \item 
        \label{exercise:convolutionAsociativity}
        \(f * (g * h) = (f * g) * h\)
      \item 
        \label{exercise:convolutionScalarAsociativity}
        \(\lambda (f * g) 
        =
        (\lambda f) * g
        = 
        f * (\lambda g)\)
      \item
        \label{exercise:convolutionL1Bound}
        \(\norm{f * g}_1 
        \leq 
        \norm{f}_1 \norm{g}_1\)
    \end{enumerate}
  \end{exercise}

  \begin{remark}
    Las propiedades anteriores se pueden resumir diciendo que \((L^1(\realNumbers^n), \norm{\placeholderParameter}_1)\) es un álgebra de Banach conmutativa con la convolución como producto.
  \end{remark}

  \begin{myLemma}
    \label{myLemma:integralDomainReflection}
    \(
      \int_{\realNumbers^n} h(y) \dd y
      =
      \int_{\realNumbers^n} h(x - y) \dd y
    \)
    para toda \(h \in \integrableFunctions\).
  \end{myLemma}
  \begin{proof}
    Sea \(H\) la clase formada por las funciones \(h \in \integrableFunctions\) que verifican el enunciado.
    Por la linealidad de la integral, la combinación \(\alpha h_1 + \beta h_2\) pertenece a \(H\) siempre que \(h_1, h_2 \in H\) y \(\alpha, \beta \in \realNumbers\).
    Por el teorema de convergencia monótona, si \(\{h_m\}_m \subseteq H\) es una sucesión nodecreciente de funciones nonegativas que converge a una función integrable \(g\), entonces \(g \in H\).
    Para concluir, debemos probar que las funciones características integrables están en \(H\).
    Supongamos que \(h \in L^1(\realNumbers^n)\) es la función característica \(h = \characteristic_A\) de un conjunto medible \(A \subseteq \realNumbers^n\) de medida finita.
    Observemos que \(\characteristic_A (x - y) = \characteristic_{x - A} (y)\) para todo par \(x, y \in \realNumbers^n\).
    A partir de esta relación pordemos calcular como, para todo \(x \in \realNumbers^n\)
    \begin{align}
      &\int_{\realNumbers^n} \characteristic_A(y) \dd y
        =      
        \lebesgueMeasure(A)
      &&\int_{\realNumbers^n} \characteristic_A(x - y) \dd y
      =
      \int_{\realNumbers^n} \characteristic_{x - A}(y) \dd y
      =
      \lebesgueMeasure(x - A)
    \end{align}
    Ahora la ecuación que necesitamos se sigue de la invarianza por traslaciones (\(+ x\)) y reflexiones (\(-\)) de la medida de Lebesgue, una propiedad que es facil de ver en el caso de los rectángulos que generan su \(\sigma\)--álgebra.
    Concretamente, sucede
    \(
      \lebesgueMeasure(A)
      =
      \lebesgueMeasure(x - A)
    \)
    para todo \(x \in \realNumbers^n\).
  \end{proof}

  \begin{proof}
    \ref{exercise:convolutionConmutativity}
    Para todo \(x \in \realNumbers^n\), como consecuencia del lema \ref{myLemma:integralDomainReflection}
    \begin{align}
      f * g (x)
      &=
      \int_{\realNumbers^n} f(y) g(x - y) \dd y
      \\
      &=
      \int_{\realNumbers^n} f(x - y) g(x - (x - y)) \dd y
      \\
      &=
      \int_{\realNumbers^n} g(y) f(x - y) \dd y
      \\
      &=
      g * f (x)
    \end{align}
  \end{proof}

  \begin{proof}
    \ref{exercise:convolutionDistributiveLaw}
    Por la ley distributiva de los números reales y la linealidad de la integral, para todo \(x \in \realNumbers^n\)
    \begin{align}
      f * (g + h) (x)
      &=
      \int_{\realNumbers^n} f(y) (g + h) (x - y) \dd y
      \\
      &=
      \int_{\realNumbers^n} f(y) g(x - y) + f(y) h(x - y)  \dd y
      \\
      &=
      \int_{\realNumbers^n} f(y) g(x - y) \dd y + \int_{\realNumbers^n} f(y) h(x - y)  \dd y
      \\
      &=
      f * g (x) + f * h (x)
    \end{align}
    La demostración del enunciado \((g + h) * f = g * f + h * f\) es similar.
  \end{proof} 

  \begin{proof}
    \ref{exercise:convolutionScalarAsociativity}
    Sea \(x \in \realNumbers^n\) arbitrario.
    Por la linealidad de la integral
    \begin{align}
      (\lambda (f * g)) (x)
      =
      \lambda \int_{\realNumbers^n} f(y) g(x - y) \dd y
      =
      \int_{\realNumbers^n} \lambda (f(y) g(x - y)) \dd y
    \end{align}
    Pero por asociatividad del producto entre números reales
    \begin{align}
      (\lambda f) * g (x)
      &=
      \int_{\realNumbers^n} (\lambda f(x)) g(x - y) \dd y
      =
      \int_{\realNumbers^n} \lambda (f(y) g(x - y)) \dd y
      \\
      f * (\lambda g) (x)
      &=
      \int_{\realNumbers^n} f(x) (\lambda g(x - y)) \dd y
      =
      \int_{\realNumbers^n} \lambda (f(y) g(x - y)) \dd y      
    \end{align}
    Comparando los extremos derechos de las desigualdades se obtiene \(\lambda (f * g) = (\lambda f) * g = f * (\lambda g)\).
  \end{proof}

  \begin{myLemma}[Convergencia monótona para convoluciones]
    \label{myLemma:convolutionMonotoneConvergence}
    Si \(f \in \integrableFunctions\), y \(\{g_m\}_m\) es una sucesión nodecreciente de funciones nonegativas que convergen puntualmente a una \(g \in \integrableFunctions\), entonces \(\lim_{m \rightarrow \infty} f * g_m =f * g\) y de forma similar \(\lim_{m \rightarrow \infty} g_m * f = g * f\).
  \end{myLemma}

  \begin{proof}
    Sea \(x \in \realNumbers^n\) arbitrario.
    Si \(f^+\) y \(f^-\) son las partes nonegativa y negativa de \(f\), y \(f^{\pm}\) es cualquiera de ellas entonces por el teorema de convergencia monótona
    \begin{align}
      \lim_{m \rightarrow \infty} f^{\pm} * g_m (x)
      &=
      \lim_{m \rightarrow \infty} \int_{\realNumbers^n} f^{\pm}(y)  g_m (x - y) \dd y
      \\
      &=
      \int_{\realNumbers^n} \lim_{m \rightarrow \infty} f^{\pm}(y)  g_m (x - y) \dd y
      \\
      &=
      \int_{\realNumbers^n} f^{\pm}(y) g(x - y) \dd y
      \\
      &=
      f^{\pm} * g (x)
    \end{align}
    En consecuencia el límite de las convoluciones es la convolución con el límite
    \begin{align}
      \lim_{m \rightarrow \infty} 
        f * g_m (x)
      &=
      \lim_{m \rightarrow \infty}
        f^+ * g_m (x)
      - \lim_{m \rightarrow \infty}
        f^- * g_m (x)
      \\
      &=
      f^+ * g (x) - f^- * g (x)
      \\
      &=
      f * g (x)
    \end{align}
    La demostración del enunciado
    \(
      \lim_{m \rightarrow \infty} 
        g_m * f (x)
      =
      g * f (x)
    \)
    es idéntica a la que recién presentamos.
  \end{proof}

  \begin{proof}
    \ref{exercise:convolutionL1Bound}
    Sean \(f, g \in \integrableFunctions\).
    Una primera desigualdad es simple
    \begin{align}
      \norm{f * g}_1
      =
      \int_{\realNumbers^n} \abs{\int_{\realNumbers^n} f(y) g(x - y) \dd y} \dd x
      \leq
      \int_{\realNumbers^n} \int_{\realNumbers^n} \abs{f(y) g(x - y)} \dd y \dd x
    \end{align}
    El teorema de Tonelli nos permite intercambiar el orden de integración para obtener
    \begin{align}
      \int_{\realNumbers^n} \int_{\realNumbers^n} \abs{f(y) g(x - y)} \dd y \dd x
      &=
      \int_{\realNumbers^n} \abs{f(y)} \int_{\realNumbers^n} \abs{g(x - y)} \dd x \dd y
    \end{align}
    El lema propio \ref{myLemma:integralDomainReflection} simplifica esta integral mediante \(\norm{g}_1 = \int_{\realNumbers^n} \abs{g(x - y)} \dd x\)
    \begin{align}
      \int_{\realNumbers^n} \abs{f(y)} \int_{\realNumbers^n} \abs{g(x - y)} \dd x \dd y
      =
      \int_{\realNumbers^n} \abs{f(y)} \norm{g}_1 \dd y
      =
      \norm{f}_1 \norm{g}_1
    \end{align}
    
  \end{proof}

\begin{myLemma}
  \label{myLemma:convolutionWithCompactlySupportedFunction}
  Si \(g \in L^1(\realNumbers^n)\) y \(\psi \in C_c(\realNumbers^n)\) entonces \(f * \psi\) es uniformemente continua.
\end{myLemma}
\begin{proof}
  Sean \(x, x' \in \realNumbers^n\).
  Una primera desigualdad es sencilla
  \begin{align}
    \abs{f * \psi (x) - f * \psi (x')}
    &=
    \abs{
      \int_{\realNumbers^n} f(y) \psi(x - y) \dd y
      -
      \int_{\realNumbers^n} f(y) \psi(x' - y) \dd y
    }
    \\
    &=
    \abs{
      \int_{\realNumbers^n} f(y) (\psi(x - y) - \psi(x' - y)) \dd y
    }
    \\
    &\leq
    \int_{\realNumbers^n} \abs{f(y)} \abs{\psi(x - y) - \psi(x' - y)} \dd y
  \end{align}
  Ahora bien, dado \(\varepsilon > 0\), existe un \(\delta > 0\) tal que \(\abs{\psi(u) - \psi(u')} < \varepsilon\) si \(\norm{u - u'} < \delta\) porque \(\psi\), al ser continua de soporte compacto, es uniformemente continua.
  Luego \(\norm{x - x'} < \delta\) implica
  \begin{align}
    \abs{f * \psi (x) - f * \psi (x')}
    &\leq
    \int_{\realNumbers^n} \abs{f(y)} \abs{\psi(x - y) - \psi(x' - y)} \dd y
    \\
    &<
    \varepsilon \int_{\realNumbers^n} \abs{f(y)} \dd y
    \\
    &=
    \varepsilon \norm{f}_1
  \end{align}
  Siendo que \(\norm{f}_1 < \infty\), podemos conluir que \(f * \psi\) es uniformemente continua.
\end{proof}

\begin{exercise}
  Probar que si \(f \in L^1_{\local}(\realNumbers^n)\) y \(\psi \in C_c(\realNumbers^n)\) entonces \(f * \psi\) es continua.
\end{exercise}
\begin{proof}
  Sean \(B_m = \bar{B}_m(0)\) las bolas cerradas de radio \(m\) centradas en \(0\).
  Aproximamos \(f\) mediante \(f_m = f \characteristic_{B_m}\) \((m \in \naturalNumbers)\).
  La integrabilidad local de \(f\) hace de cada \(f_m\) una función integrable.
  Por el lema \ref{myLemma:convolutionWithCompactlySupportedFunction}, las funciones \(f_m * \psi\) son uniformemente continuas.
  Además, se da la convergencia uniforme en compactos \(f_m * \psi \rightarrow f * \psi\).
  Para verlo fijemos un conjunto compacto \(K \subseteq \realNumbers^n\).
  Existe un \(M \in \naturalNumbers\) lo suficientemente grande, dependiendo de \(K\), tal que \(K \subseteq B_M\).
  Luego, para todo \(x \in K\) y para todo \(m \geq M\)
  \begin{align}
    f_m * \psi (x)
    &=
    \int_{\realNumbers^n} f_m (y) \psi(x - y) \dd y
    \\
    &=
    \int_{\realNumbers^n} f (y) \characteristic_{B_m} (y) \psi(x - y) \dd y
    \\
    &=
    \int_{\realNumbers^n} f (y) \psi(x - y) \dd y
    \\
    &=
    f * \psi (x)
  \end{align}
  Queda probada la convergencia uniforme en compactos.
  Pero el límite, en este caso \(f * \psi\), uniforme en compactos de una sucesión de funciones uniformemente continuas, aquí las \(f_m\), es continuo.
  Por lo tanto \(f * \psi\) es una función continua.
\end{proof}
% \end{}

\begin{exercise}
  Probar que si \(f \in \locallyIntegrableFunctions\) y \(\psi \in C^{\infty}_c(\realNumbers^n)\) entonces \(\partial_{x_i} (\psi * f) = f * \partial_{x_i} \psi\).
\end{exercise}
\begin{remark}
  Como consecuencia \(f * \psi \in C^{\infty}(\realNumbers^n)\).
\end{remark}

\begin{proof}
  Sea \(x \in \realNumbers^n\) un vector fijo.
  Calculamos
  \begin{align}
    \partial_{x_i} (f * \psi)(x)
    &=
    \lim_{h \rightarrow 0} h^{- 1} ((f * \psi)(x + h e_i) - (f * \psi)(x))
    \\
    &=
    \lim_{h \rightarrow 0}
      \int_{\realNumbers^n} f(y)  
      \frac{\psi(x + h e_i - y) - \psi(x - y)}{h}
      \dd y
  \end{align}
  El análisis de este límite constará de tres partes.
  Primero acotamos la región de integración.
  Definimos \(\phi_h(y) = h^{- 1} (\psi(x + h e_i - y) - \psi(x - y))\) para \(y \in \realNumbers^n\) y \(h \in \realNumbers \setminus 0\).
  Podemos probar que el soporte de las todas las funciones \(\phi_h\) está contenido en una bola si nos restringimos a los desplazamientos \(h \in [-1, 1]\).
  Sabemos que \(\psi\) tiene soporte compacto, por lo cual se anula en \(\realNumbers^n \setminus B_r\), el complemento de la bola centrada en 0 de radio \(r\).
  Escogiendo \(r' = r + \norm{x} + 1\) podemos asegurar que \(\norm{y} \geq r'\) implica 
  \begin{align}
    r
    &=
    r' - \norm{x} - 1
      &&& 
      r
      &=
      r' - \norm{x} - 1
    \\
    &\leq
    \norm {y} - \norm{x} - 1 
      &&&
      &\leq
      \norm{y} - \norm{x} - 1
    \\
    &\leq 
    \norm{y} - \norm{x + h e_i} 
      &&&
      &\leq
      \norm{y} - \norm{x}
    \\
    &\leq 
    \abs{\norm{x + h e_i} - \norm{y}} 
      &&&
      &\leq
      \abs{\norm{x} - \norm{y}}
    \\
    &\leq 
    \norm{x + h e_i - y}
      &&&
      &\leq
      \norm{x - y}
  \end{align}
  y estas desigualdades a su vez nos permiten deducir
  \(
    \psi(x + h e_i - y)
    =
    \psi(x - y)
    =
    0
  \).
  En conclusión, las funciones \(\phi_h\) con \(h \in [-1, 1]\) se anulan sobre el conjunto \(\realNumbers^n \setminus B_{r'}\).
  
  En segundo lugar controlamos el integrando.
  Por el teorema del valor medio
  \(
    \abs{\psi(x + h e_i - y) - \psi(x - y)}
    \leq
    \norm{\partial_{x_i} \psi}_{\infty} \abs{h}
  \)
  para todo \(y \in \realNumbers^n\).
  Pero \(\partial_{x_i} \psi \in C^{\infty}_c(\realNumbers^n)\) porque \(\psi \in C^{\infty}_c(\realNumbers^n)\).
  Luego \(C = \norm{\partial_{x_i} \psi}_{\infty} < \infty\).
  Esto asegura \(\abs{\phi_h} \leq C\) para todo \(h \in \realNumbers \setminus 0\).
  
  En tercer y último lugar, aplicamos el teorema de convergencia dominada.
  En el primer y segundo paso probamos que \(\abs{\phi_h} \leq C \characteristic_{B_{r'}}\) para todo \(h \in [- 1, 1]\).
  Partiendo de esto, el integrando \(f \phi_h\) está dominado por una función \(g = C \abs{f} \characteristic_{B_{r'}}\).
  Esta \(g\) resulta integrable porque \(f\) es localmente integrable.
  Luego el teorema de la convergencia dominada implica
  \begin{align}
    \lim_{h \rightarrow 0}
      \int_{\realNumbers^n} f(y) \phi_h(y) \dd y
    =
    \int_{\realNumbers^n}
      f(y)
      \lim_{h \rightarrow 0} \phi_h(y) \dd y
  \end{align}
  Pero \(\psi \in C^{\infty}(\realNumbers^n)\), entonces
  \begin{align}
    &\lim_{h \rightarrow 0} \phi_h(y) = \partial_{x_i} \psi (x - y)
    && (\forall y \in \realNumbers^n)
  \end{align}
  Es decir
  \begin{align}
    \partial_{x_i} (f * \psi) (x)
    =
    f * (\partial_{x_i} \psi) (x)
  \end{align}
  Con la conmutatividad de la convolución podemos llegar al enunciado preciso del ejercicio.
\end{proof}
\end{document}